cmake_minimum_required( VERSION 3.0)

set                   ( CMAKE_CONFIGURATION_TYPES "Debug;Release;RelWithDebinfo" CACHE STRING "limited configs" FORCE )
set                   ( NOT_USE_DAVA_LIBRARY  1 )

project               ( Launcher )
set                   ( CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_LIST_DIR}/../../Sources/CMake/Modules/" ) 
include               ( CMake-common )

find_package          ( QT5 REQUIRED )
find_package          ( Qt5Network   )
find_package          ( Qt5WebKitWidgets   ) 

add_subdirectory      ( "${CMAKE_CURRENT_LIST_DIR}/ThirdParty/quazip" ${CMAKE_CURRENT_BINARY_DIR}/quazip )
add_subdirectory      ( "${CMAKE_CURRENT_LIST_DIR}/ThirdParty/yaml" ${CMAKE_CURRENT_BINARY_DIR}/yaml )

include_directories   ( ${DAVA_INCLUDE_DIR} ) 
include_directories   ( ${DAVA_THIRD_PARTY_INCLUDES_PATH} )
include_directories   ( ${CMAKE_CURRENT_BINARY_DIR} )

include_directories   (.)             
include_directories   ( "Classes" )
include_directories   ( "ThirdParty/quazip" )
include_directories   ( "ThirdParty/yaml/include" )

add_definitions       ( -DQUAZIP_STATIC )

file                  ( GLOB_RECURSE QT_LIST "Classes/*.h"  )
qt5_wrap_cpp          ( MOC_APP_SRCS ${QT_LIST} )

file                  ( GLOB UI_LIST "DataQt/*.ui" )
qt5_wrap_ui           ( UI_APP_HDRS  ${UI_LIST} )
                   
file                  ( GLOB RCC_LIST "DataQt/*.qrc" )
qt5_add_resources     ( RCC_APP_SRCS  ${RCC_LIST} )

set                   ( Generated  ${MOC_APP_SRCS} ${UI_APP_HDRS} ${RCC_APP_SRCS} )

define_source_folders          ( SRC_ROOT "Classes"  )
generate_source_groups_project ( SRC_ROOT "Classes" "Data" "DataQt"  )

list( APPEND QT_LIBRARIES  Qt5::Network Qt5::WebKitWidgets )

set( MACOS_PLIST          ${CMAKE_CURRENT_LIST_DIR}/MacOSSpecific/Info.plist )
set( MACOS_ICO            ${CMAKE_CURRENT_LIST_DIR}/MacOSSpecific/icon.icns  )
set( MACOS_DATA           ${CMAKE_CURRENT_LIST_DIR}/Data/* )
set( MACOS_DYLIB          ${DAVA_THIRD_PARTY_ROOT_PATH}/IMagickHelpLib/libIMagickHelper.dylib )

set( ADDED_SRC            ${MOC_APP_SRCS} ${UI_APP_HDRS} ${RCC_APP_SRCS}  )

set( LIBRARIES            ${QT_LIBRARIES}  quazip yaml-cpp  )
set( LIBRARIES_RELEASE    msvcrt.lib  ${CMAKE_CURRENT_LIST_DIR}/ThirdParty/zlib.lib   )
set( LIBRARIES_DEBUG      msvcrtd.lib ${CMAKE_CURRENT_LIST_DIR}/ThirdParty/zlibd.lib  )
set( ADDED_BINARY_DIR     ${QT5_PATH_WIN}/bin )

setup_main_executable()



